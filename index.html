<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pixel Art Maker v1.2 ‚Äî Alex Johnston</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="layout">
    <aside id="sidebar">
      <h2>üõ†Ô∏è Tools</h2>

      <div class="tool-section">
        <label class="toggle">
          <input type="radio" name="mode" value="color" checked />
          <span class="tag">Paint Color</span>
        </label>
        <label class="toggle">
          <input type="radio" name="mode" value="transparent" />
          <span class="tag">Erase Transparent</span>
        </label>
      </div>

      <div class="tool-section">
        <label class="toggle">
          <input type="checkbox" id="dragToggle" checked />
          <span class="tag">Enable Drag Drawing</span>
        </label>
      </div>

      <div class="tool-section">
        <label for="resolution">üéûÔ∏è Resolution</label>
        <select id="resolution">
          <option value="16">8-bit (16√ó16)</option>
          <option value="32">24-bit (32√ó32)</option>
          <option value="64" selected>64-bit (64√ó64)</option>
          <option value="128">128-bit (128√ó128)</option>
        </select>
      </div>

      <div class="tool-section">
        <button onclick="location.href='about.html'" id="aboutBtn">üìñ About This App</button>
      </div>
    </aside>

    <main>
      <header>
        <h1>üß± Pixel Art Maker</h1>
        <p class="subheading">Retro-powered pixels, handcrafted by Alex Johnston</p>
      </header>

      <section id="controls">
        <input type="color" id="colorPicker" value="#ff0000" />
        <button id="saveBtn">üíæ Save PNG</button>
      </section>

      <div id="grid"></div>
      <canvas id="canvas" width="640" height="640"></canvas>

      <footer>
        <div class="dev-info">
          <strong>Version 1.2</strong> ‚Äî Built by <strong>Alex Johnston</strong><br />
          <a href="https://github.com/ajohnston49" target="_blank">GitHub: ajohnston49</a><br />
          <span>Modular coder | Pixel engineer | Fast thinker</span>
        </div>
      </footer>
    </main>
  </div>

  <script>
    const grid = document.getElementById('grid');
    const resolution = document.getElementById('resolution');
    const colorPicker = document.getElementById('colorPicker');
    const saveBtn = document.getElementById('saveBtn');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const dragToggle = document.getElementById('dragToggle');

    let cells = [];
    let currentColor = colorPicker.value;
    let paintMode = 'color';
    let gridSize = parseInt(resolution.value);
    const canvasSize = 640;
    let isMouseDown = false;
    let dragEnabled = dragToggle.checked;

    dragToggle.addEventListener('change', (e) => {
      dragEnabled = e.target.checked;
    });

    document.body.addEventListener('mousedown', () => isMouseDown = true);
    document.body.addEventListener('mouseup', () => isMouseDown = false);

    function clearGrid() {
      grid.innerHTML = '';
      cells = [];
    }

    function createGrid(size) {
      clearGrid();
      gridSize = size;
      const cellSize = canvasSize / size;

      grid.style.width = `${canvasSize}px`;
      grid.style.height = `${canvasSize}px`;
      grid.style.gridTemplateColumns = `repeat(${size}, ${cellSize}px)`;
      grid.style.gridTemplateRows = `repeat(${size}, ${cellSize}px)`;

      canvas.width = canvasSize;
      canvas.height = canvasSize;

      for (let i = 0; i < size * size; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.style.width = `${cellSize}px`;
        cell.style.height = `${cellSize}px`;
        grid.appendChild(cell);
        cells.push(cell);

        cell.addEventListener('mousedown', () => applyPaint(cell));
        cell.addEventListener('mouseenter', () => {
          if (isMouseDown && dragEnabled) applyPaint(cell);
        });
      }
    }

    function applyPaint(cell) {
      cell.style.background = (paintMode === 'color') ? currentColor : 'rgba(0,0,0,0)';
    }

    colorPicker.addEventListener('input', () => {
      currentColor = colorPicker.value;
    });

    resolution.addEventListener('change', () => {
      const newSize = parseInt(resolution.value);
      createGrid(newSize);
    });

    document.querySelectorAll('input[name="mode"]').forEach(radio => {
      radio.addEventListener('change', () => {
        paintMode = radio.value;
      });
    });

    saveBtn.onclick = () => {
      cells.forEach((cell, i) => {
        const col = i % gridSize;
        const row = Math.floor(i / gridSize);
        const bg = window.getComputedStyle(cell).backgroundColor;
        ctx.fillStyle = bg.includes('rgba(0, 0, 0, 0)') ? 'rgba(0,0,0,0)' : bg;
        ctx.fillRect(col * 10, row * 10, 10, 10);
      });
      const link = document.createElement('a');
      link.download = `pixel_art_${gridSize}x${gridSize}.png`;
      link.href = canvas.toDataURL();
      link.click();
    };

    createGrid(gridSize);
  </script>
</body>
</html>
